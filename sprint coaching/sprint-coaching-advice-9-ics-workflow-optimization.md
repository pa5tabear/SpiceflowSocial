# Sprint Coaching Advice #9 ‚Äî ICS Workflow Optimization for Daily Usage

**Prepared by:** Codex (Product Manager & Sprint Coach)
**Date:** 2025-09-28
**Focus:** Optimize ICS generation for 7-day rolling window with daily updates

## üéØ CURRENT SYSTEM ANALYSIS

### How ICS Generation Currently Works:
1. **Multiple ICS Files Generated:**
   - `data/out/winners.ics` - Selected events only (what you want)
   - `data/merged/all_events.ics` - All discovered events (too much)
   - `data/events_batches/batch_DATE/SOURCE.ics` - Per-source files (unnecessary)

2. **Key File:** `data/out/winners.ics` is already what you want
   - Contains only recommended/selected events
   - Generated by portfolio selection system
   - Uses proper calendar naming from preferences

3. **Supporting Files:**
   - `data/out/shortlist.md` - Markdown description of selected events
   - `data/out/portfolio.json` - Full selection data with scoring

## ‚úÖ WHAT'S WORKING CORRECTLY

**Your desired workflow is already mostly implemented:**
- ‚úÖ **Single ICS file:** `winners.ics` contains only selected events
- ‚úÖ **7-day window:** System uses `--horizon-days 7` for planning
- ‚úÖ **Markdown descriptions:** `shortlist.md` describes all selected events
- ‚úÖ **Apple Calendar ready:** ICS format is fully compatible

## üîß OPTIMIZATIONS NEEDED

### 1. **Enhanced Markdown for Easy Review/Editing**
**Current:** Basic shortlist format
**Needed:** Rich markdown with approval/disapproval workflow

### 2. **Daily Rolling Updates**
**Current:** Full regeneration each run
**Needed:** Smart daily additions with change tracking

### 3. **Event Management Workflow**
**Current:** No cancellation/modification support
**Needed:** Easy event editing and change suggestions

## üöÄ IMPLEMENTATION PLAN

### Priority 1: Enhanced Review Markdown (THIS WEEK)

**Create:** `data/out/weekly_review.md` with this structure:

```markdown
# Weekly Event Review - Sept 28 - Oct 5, 2025

**Status:** 7 events selected for next 7 days
**Last Updated:** 2025-09-28 17:30 EDT
**ICS File:** `data/out/winners.ics` (ready to import)

## üìÖ Daily Breakdown

### Monday, Sept 30
**‚úÖ APPROVED** Powering Tomorrow: Clean Energy Future
- **When:** 5:30 PM - 7:00 PM
- **Where:** Rackham Auditorium, 915 E Washington St
- **Why Selected:** High-profile keynote (Jennifer Granholm), sustainability goal alignment
- **Score:** 1.88 (career: 0.9, social: 0.3, location: 0.0)
- **Notes:** Former Energy Secretary, Climate Week keynote
- **Actions:** [ ] Keep [ ] Modify [ ] Cancel

### Tuesday, Oct 1
**üîç NEEDS REVIEW** No events currently selected
- **Suggestions:** Check for late-added events, consider backup options
- **Actions:** [ ] Find alternatives [ ] Keep open [ ] Add specific search

[Continue for each day...]

## üéØ Weekly Overview
- **Career Learning:** 2 events (goal: 2+ ‚úÖ)
- **Social Connection:** 1 event (goal: 2+ ‚ùå)
- **Outdoors/Wellbeing:** 0 events (goal: 1+ ‚ùå)
- **Budget:** $15 total (cap: $150 ‚úÖ)
- **Travel:** All within 15 minutes ‚úÖ

## üìù Quick Edit Commands

**To approve all:** "Approve all suggested events"
**To cancel specific:** "Cancel [event name] on [day]"
**To modify:** "Move [event name] to [new time] if possible"
**To add:** "Find [type] event for [day] evening"

## üîÑ Tomorrow's Update Preview
When you run tomorrow (Sept 29), the system will:
- Add suggestions for Oct 6 (new day 8)
- Review Sept 30-Oct 5 for changes/cancellations
- Suggest quota adjustments if needed
- Flag any conflicts with your actual calendar
```

### Priority 2: Daily Rolling Update Logic (THIS WEEK)

**Enhance `src/run_all.py` with rolling update support:**

```python
def generate_rolling_update(previous_portfolio, new_events, horizon_days=7):
    """
    Generate daily updates that:
    1. Add new day (day 8) suggestions
    2. Check existing days for changes/cancellations
    3. Suggest modifications to maintain goals
    4. Flag conflicts or improvements
    """
    # Load yesterday's selections
    # Compare with new event discovery
    # Generate change recommendations
    # Create updated 7-day window
```

### Priority 3: Change Detection & Suggestions (NEXT WEEK)

**Add smart change detection:**
- **Event Cancellations:** Detect when previously selected events no longer exist
- **Better Alternatives:** Find higher-scoring events that appeared
- **Goal Rebalancing:** Suggest swaps to meet weekly quotas
- **Conflict Resolution:** Handle schedule conflicts with actual calendar

## üìã IMPLEMENTATION DETAILS

### Step 1: Enhanced Markdown Generation (30 minutes)

**Create:** `src/emit/weekly_review.py`

```python
def write_weekly_review(selected_events, portfolio_data, output_path):
    """Generate comprehensive weekly review markdown"""
    # Group events by day
    # Calculate goal fulfillment
    # Generate approval/disapproval template
    # Add quick edit commands
    # Include change preview for tomorrow
```

### Step 2: Update Main Pipeline (15 minutes)

**In `src/run_all.py`, add:**

```python
# After portfolio selection:
write_weekly_review(
    portfolio["selected"],
    portfolio,
    Path("data/out/weekly_review.md")
)
```

### Step 3: Rolling Update Support (45 minutes)

**Add change detection:**
- Load previous day's `portfolio.json`
- Compare event availability and scoring
- Generate change recommendations
- Update selections with minimal disruption

### Step 4: Integration Commands (15 minutes)

**Add CLI options:**
```bash
python src/run_all.py --rolling-update  # Daily mode
python src/run_all.py --full-refresh    # Weekly mode
```

## üéØ ENHANCED WORKFLOW

### Daily Usage Pattern:
1. **Morning:** Run `python src/run_all.py --rolling-update --horizon-days 7`
2. **Review:** Check `data/out/weekly_review.md` for changes
3. **Edit:** Use LLM prompt with markdown to approve/modify selections
4. **Import:** Import updated `data/out/winners.ics` to Apple Calendar

### Weekly Pattern:
1. **Sunday:** Run full refresh to reset 7-day window
2. **Plan:** Review full week in `weekly_review.md`
3. **Approve:** Bulk approve or modify via LLM prompt editing

## üìä SUCCESS METRICS

### User Experience:
- **Single ICS Import:** One file contains complete 7-day plan
- **Easy Review:** Markdown format perfect for LLM editing
- **Quick Changes:** Simple approval/disapproval workflow
- **Rolling Updates:** Minimal daily maintenance

### Technical Quality:
- **No Duplicates:** Clean ICS with unique events only
- **Proper Scoring:** All events include goal alignment rationale
- **Change Tracking:** Clear documentation of daily modifications
- **Goal Monitoring:** Weekly quota tracking and adjustment

## üöÄ IMMEDIATE NEXT ACTIONS

### For Programming Team (Next 2 Days):
1. **Create `weekly_review.py`** with comprehensive markdown generation
2. **Test current ICS workflow** - verify `winners.ics` contains only selected events
3. **Add rolling update logic** to detect changes between daily runs
4. **Document CLI commands** for daily vs weekly modes

### For Product Testing (Next 1 Week):
1. **Import `winners.ics`** into Apple Calendar to test compatibility
2. **Review `weekly_review.md`** format for editing convenience
3. **Test daily workflow** with rolling updates
4. **Provide feedback** on markdown editing experience

### For System Integration:
1. **Verify goal tracking** matches actual preferences
2. **Test change detection** with sample event modifications
3. **Validate scoring** against manual preference assessment
4. **Document LLM prompt patterns** for efficient event editing

## üí° OPTIMIZATION OPPORTUNITIES

### Enhanced Markdown Features:
- **Calendar Preview:** Show week view with time blocks
- **Conflict Detection:** Flag potential scheduling issues
- **Alternative Suggestions:** List backup options for each day
- **Goal Progress:** Visual tracking of weekly targets

### Smart Suggestions:
- **Seasonal Adjustments:** Adapt recommendations for weather/holidays
- **Learning Integration:** Incorporate feedback from previous selections
- **Social Optimization:** Balance individual vs group activities
- **Energy Management:** Consider daily intensity and recovery

## ‚ö†Ô∏è CRITICAL SUCCESS FACTORS

1. **Single Source of Truth:** `winners.ics` must be the only file you need to import
2. **Easy Editing:** Markdown format must work smoothly with LLM editing workflows
3. **Minimal Maintenance:** Daily updates should require <5 minutes review
4. **Goal Alignment:** Weekly selections must meet your stated preferences and quotas
5. **Change Resilience:** System must handle event cancellations and modifications gracefully

---

**BOTTOM LINE:** The current system already generates the single ICS file you want (`winners.ics`). The enhancements focus on better review/editing workflow and smart daily updates to minimize maintenance while maximizing goal achievement.